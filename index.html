<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>奶香资源站</title>
  <style>
    body { margin:0; font-family:"Microsoft YaHei",Arial,sans-serif; background:#f9f9f9; }
    header { background:#f36; color:#fff; padding:10px 20px; display:flex; justify-content:space-between; align-items:center; }
    header h1 { font-size:22px; margin:0; }
    header .search { display:flex; gap:5px; }
    header input { padding:6px; border:none; border-radius:3px; }
    header button { padding:6px 12px; border:none; background:#fff; color:#f36; border-radius:3px; cursor:pointer; }
    nav { background:#ff6699; display:flex; flex-wrap:wrap; padding:10px 20px; gap:15px; }
    nav a { color:#fff; font-weight:bold; }
    .categories { display:grid; grid-template-columns: repeat(auto-fill,minmax(120px,1fr)); gap:10px; padding:15px 20px; background:#fff; border-bottom:2px solid #eee; }
    .categories button { padding:8px; border:none; background:#ffe6f0; border-radius:5px; cursor:pointer; transition:0.3s; font-size:14px; }
    .categories button.active { background:#f36; color:#fff; font-weight:bold; }
    .movies { display:grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap:15px; padding:20px; }
    .movie-card { background:#fff; border:1px solid #eee; border-radius:8px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.05); transition:0.3s; }
    .movie-card:hover { transform:translateY(-3px); box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    .movie-card img { width:100%; height:280px; object-fit:cover; }
    .movie-info { padding:10px; font-size:14px; }
    .movie-info h3 { margin:0 0 6px; font-size:16px; color:#333; }
    .movie-info p { margin:2px 0; color:#666; font-size:13px; }
    .movie-info a { display:inline-block; margin-top:8px; padding:5px 10px; background:#f36; color:#fff; border-radius:4px; font-size:13px; text-decoration:none; }
    .movie-info a:hover { background:#d02450; }
    .pagination { display:flex; justify-content:center; gap:8px; margin:20px; flex-wrap:wrap; }
    .pagination button { padding:6px 12px; border:1px solid #ddd; border-radius:4px; background:#fff; color:#f36; cursor:pointer; }
    .pagination button.active { background:#f36; color:#fff; font-weight:bold; }
    .pagination button:disabled { color:#aaa; cursor:not-allowed; }
    footer { text-align:center; padding:15px; font-size:13px; color:#666; background:#fefefe; margin-top:20px; border-top:1px solid #eee; }
  </style>
</head>
<body>
  <!-- 顶部 -->
  <header>
    <h1>奶香资源站</h1>
    <div class="search">
      <input type="text" id="searchInput" placeholder="请输入影片名称...">
      <button onclick="searchMovies()">搜索</button>
    </div>
  </header>
  
  <!-- 导航栏 -->
  <nav>
    <a href="#">首页</a>
    <a href="#">演示站</a>
    <a href="#">采集教程</a>
    <a href="#">苹果cmsv10模版</a>
    <a href="#">TG交流群</a>
    <a href="#">福利赞助</a>
  </nav>
  
  <!-- 分类标签 -->
  <section class="categories" id="categoryButtons">
    <button class="active" onclick="filterCategory('全部', this)">全部</button>
    <button onclick="filterCategory('国产影片', this)">国产影片</button>
    <button onclick="filterCategory('中文字幕', this)">中文字幕</button>
    <button onclick="filterCategory('欧美影片', this)">欧美影片</button>
    <button onclick="filterCategory('剧情大片', this)">剧情大片</button>
  </section>
  
  <!-- 影片展示区域 -->
  <section class="movies" id="movieList"></section>

  <!-- 分页 -->
  <div class="pagination" id="pagination"></div>
  
  <!-- 页脚 -->
  <footer>
    © 2025 奶香资源站 - JSON 数据驱动分页版 | GitHub Pages 部署
  </footer>

  <!-- JSON 加载 + 分类/搜索 + 分页 -->
  <script>
    let moviesData = [];
    let currentCategory = "全部";
    let currentPage = 1;
    const itemsPerPage = 20;

    async function loadMovies() {
      const res = await fetch("movies.json");
      moviesData = await res.json();
      renderMovies();
    }

    function getFilteredMovies() {
      let searchValue = document.getElementById("searchInput").value.toLowerCase();
      return moviesData.filter(m => {
        let matchCategory = (currentCategory === "全部" || m.category === currentCategory);
        let matchSearch = (m.title.toLowerCase().includes(searchValue));
        return matchCategory && matchSearch;
      });
    }

    function renderMovies() {
      let list = document.getElementById("movieList");
      list.innerHTML = "";

      let filtered = getFilteredMovies();
      let totalPages = Math.ceil(filtered.length / itemsPerPage);

      if (currentPage > totalPages) currentPage = totalPages || 1;

      let start = (currentPage - 1) * itemsPerPage;
      let end = start + itemsPerPage;
      let pageItems = filtered.slice(start, end);

      pageItems.forEach(m => {
        let card = `
          <div class="movie-card">
            <img src="${m.image}" alt="${m.title}">
            <div class="movie-info">
              <h3>${m.title}</h3>
              <p>分类：${m.category}</p>
              <p>更新：${m.date}</p>
              <a href="${m.link}" target="_blank">查看</a>
            </div>
          </div>
        `;
        list.innerHTML += card;
      });

      if (pageItems.length === 0) {
        list.innerHTML = "<p style='grid-column:1/-1;text-align:center;color:#999;'>没有找到相关影片</p>";
      }

      renderPagination(totalPages);
    }

    function renderPagination(totalPages) {
      let pagination = document.getElementById("pagination");
      pagination.innerHTML = "";

      if (totalPages <= 1) return;

      let prevBtn = document.createElement("button");
      prevBtn.textContent = "« 上一页";
      prevBtn.disabled = (currentPage === 1);
      prevBtn.onclick = () => { currentPage--; renderMovies(); };
      pagination.appendChild(prevBtn);

      for (let i = 1; i <= totalPages; i++) {
        let btn = document.createElement("button");
        btn.textContent = i;
        if (i === currentPage) btn.classList.add("active");
        btn.onclick = () => { currentPage = i; renderMovies(); };
        pagination.appendChild(btn);
      }

      let nextBtn = document.createElement("button");
      nextBtn.textContent = "下一页 »";
      nextBtn.disabled = (currentPage === totalPages);
      nextBtn.onclick = () => { currentPage++; renderMovies(); };
      pagination.appendChild(nextBtn);
    }

    function filterCategory(category, button) {
      currentCategory = category;
      currentPage = 1;
      let buttons = document.querySelectorAll("#categoryButtons button");
      buttons.forEach(btn => btn.classList.remove("active"));
      button.classList.add("active");
      renderMovies();
    }

    function searchMovies() {
      currentPage = 1;
      renderMovies();
    }

    // 初始化加载
    loadMovies();
  </script>
</body>
</html>
